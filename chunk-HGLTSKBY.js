import{b as U,c as u,d as A,e as G,f as j,g as E,h as q,i as z,j as R,l as Y,m as $}from"./chunk-OEDXWUF3.js";import{a as N}from"./chunk-FUBQXE6N.js";import{a as B}from"./chunk-T3JMRARM.js";import{a as V}from"./chunk-4LWUVTOG.js";import{c as O,d as T}from"./chunk-PT246GS5.js";import"./chunk-B4AESGRH.js";import{a as M}from"./chunk-UZIZ2SC3.js";import{a as I}from"./chunk-5AEEOLU3.js";import"./chunk-IFK5JYCE.js";import"./chunk-OCIR5Z6U.js";import"./chunk-SFNPABOD.js";import"./chunk-RDI242HM.js";import{Bb as F,Ea as a,Oa as P,W as _,Wa as d,Xa as L,Za as y,_ as D,ab as v,db as c,eb as w,fb as S,gb as b,ha as f,hb as r,ia as g,ib as o,jb as p,kb as x,qb as C,rb as m,sb as k,xb as s,yb as h}from"./chunk-A2AZSFLI.js";var H=()=>[import("./chunk-CXOYTFUN.js").then(e=>e.TitlePrincipalComponent),q,U,A,G,z,R,T,import("./chunk-MWWCK7B6.js").then(e=>e.LoadingButtonComponent)];function J(e,n){e&1&&(r(0,"p",2),s(1,"Todos los campos son obligatorios"),o())}function K(e,n){e&1&&(r(0,"p",2),s(1,"El correo es obligatorio"),o())}function Q(e,n){e&1&&(r(0,"p",2),s(1,"Debe ser un correo valido"),o())}function W(e,n){if(e&1&&(r(0,"p",2),s(1),o()),e&2){let i=n.$implicit;a(),h(i)}}function X(e,n){if(e&1&&S(0,W,2,1,"p",2,w),e&2){let i,t=m(2);b((i=t.loginErrors().errorNews)==null||i.errors==null?null:i.errors.email)}}function Z(e,n){if(e&1){let i=x();r(0,"i",18),C("click",function(){f(i);let l=m(2);return g(l.showPassword())}),o()}}function ee(e,n){if(e&1){let i=x();r(0,"i",19),C("click",function(){f(i);let l=m(2);return g(l.showPassword())}),o()}}function te(e,n){e&1&&(r(0,"p",2),s(1,"La contrase\xF1a es obligatoria"),o())}function ie(e,n){if(e&1&&(r(0,"p",2),s(1),o()),e&2){let i=n.$implicit;a(),h(i)}}function ne(e,n){if(e&1&&S(0,ie,2,1,"p",2,w),e&2){let i,t=m(2);b((i=t.loginErrors().errorNews)==null||i.errors==null?null:i.errors.password)}}function oe(e,n){if(e&1&&(r(0,"div")(1,"p",2),s(2),o()()),e&2){let i,t=m(2);a(2),h((i=t.loginErrors().errorNews)==null?null:i.message)}}function re(e,n){if(e&1&&(r(0,"button",14),s(1,"Ingresar"),o()),e&2){let i=m(2);v("disabled",i.loginForm.invalid)}}function le(e,n){e&1&&(r(0,"button",15),p(1,"app-loading-button"),o())}function ae(e,n){if(e&1){let i=x();p(0,"div",1),d(1,J,2,0,"p",2),r(2,"div",3),p(3,"app-title-principal",4),o(),r(4,"form",5),C("submit",function(){f(i);let l=m();return g(l.loginUser())}),r(5,"div",6)(6,"label",7),s(7,"Correo *"),o(),p(8,"input",8),d(9,K,2,0,"p",2)(10,Q,2,0,"p",2)(11,X,2,0),o(),r(12,"div",6)(13,"label",9),s(14,"Contrase\xF1a *"),o(),p(15,"input",10),r(16,"div"),d(17,Z,1,0,"i",11)(18,ee,1,0,"i",12),o(),d(19,te,2,0,"p",2)(20,ne,2,0),o(),d(21,oe,3,1,"div"),r(22,"div",13),d(23,re,2,1,"button",14)(24,le,2,0,"button",15),o(),r(25,"div",13)(26,"a",16),s(27,"Olvide m\xED contrase\xF1a"),o()(),r(28,"div",13)(29,"a",17),s(30,"Registrarme"),o()()(),p(31,"div",1)}if(e&2){let i,t=m();a(),c(t.valid?1:-1),a(3),v("formGroup",t.loginForm),a(5),c(!(t.email==null||t.email.errors==null)&&t.email.errors.required&&(t.email!=null&&t.email.touched)?9:-1),a(),c(!(t.email==null||t.email.errors==null)&&t.email.errors.email?10:-1),a(),c(t.loginErrors()?11:-1),a(4),k("type",t.viewPassword?"text":"password"),a(2),c(t.viewPassword?17:18),a(2),c(!(t.password==null||t.password.errors==null)&&t.password.errors.required&&(t.password!=null&&t.password.touched)?19:-1),a(),c(t.loginErrors()?20:-1),a(),c(((i=t.loginErrors().message)==null?null:i.error)===!0?21:-1),a(2),c(t.loadingButton?24:23)}}function se(e,n){e&1&&p(0,"app-spiner")(1,"div",1)}var be=(()=>{let n=class n{constructor(){this.loginForm=new j({email:new E(""),password:new E("")}),this.formbuilder=_(Y),this.userService=_(B),this.router=_(O),this.loginUserService=_(N),this.cookieService=_(M),this.alertsService=_(V),this.loginErrors=P({}),this.viewPassword=!1,this.valid=!1,this.loadingButton=!1}ngOnInit(){this.loginForm=this.formbuilder.group({email:["",u.compose([u.required,u.email])],password:["",u.compose([u.required])]})}ngOnDestroy(){this.unsubscribe&&this.unsubscribe?.unsubscribe()}showPassword(){this.viewPassword=!this.viewPassword}get email(){return this.loginForm.get("email")}get password(){return this.loginForm.get("password")}loginUser(){this.loadingButton=!0,this.cookieService.check("token")?(this.loginErrors.set({messageErrorSesion:"Ya hay una sesi\xF3n activa"}),this.showAlert("error","Ya hay una sesi\xF3n activa")):this.loginForm.valid?(this.loadingButton=!this.loadingButton,this.unsubscribe=this.userService.login(this.loginForm.value).subscribe({next:t=>{let l=new Date;l.setDate(l.getDate()+30),this.cookieService.set("token",t.noti_token,l,"/",void 0,!0,"Strict"),this.cookieService.set("id",t.data.id,l,"/",void 0,!0,"Strict"),this.cookieService.set("name",t.data.name,l,"/",void 0,!0,"Strict"),this.cookieService.set("lastname",t.data.lastname,l,"/",void 0,!0,"Strict"),this.cookieService.set("success",t.response,l,"/",void 0,!0,"Strict"),this.loginUserService.setUserLoginActive(!1),this.loadingButton=!1,this.loginUserService.setUserLoginActive(!1),this.showAlert(t.response,t.message),this.router.navigate(["/"]),this.loginForm.reset()},error:t=>{this.loadingButton=!1,this.loginErrors.set(t)},complete:()=>{}})):this.valid=!this.valid}showAlert(t,l){this.alertsService.showAlert(t,l)}};n.\u0275fac=function(l){return new(l||n)},n.\u0275cmp=D({type:n,selectors:[["app-login"]],standalone:!0,features:[F],decls:5,vars:0,consts:[[1,"conteiner-login"],[1,"separator"],[1,"alert","alert-error"],[1,"conteiner-login__title"],["title","Noticursos inicio de sesi\xF3n"],[1,"conteiner-login__form",3,"submit","formGroup"],[1,"conteiner-login__form--item"],["for","email"],["formControlName","email","type","email","name","email","id","email","autocomplete","email"],["for","password"],["formControlName","password","name","password","id","password","autocomplete","current-password",3,"type"],[1,"fa-solid","fa-eye"],[1,"fa-solid","fa-eye-slash"],[1,"conteiner-login__form--item","center"],[1,"btn",3,"disabled"],[1,"btn"],["routerLink","/recuperar-contrasena"],["routerLink","/registrarse"],[1,"fa-solid","fa-eye",3,"click"],[1,"fa-solid","fa-eye-slash",3,"click"]],template:function(l,ce){l&1&&(r(0,"div",0),d(1,ae,32,11)(2,se,2,0),L(3,1,H,null,2),y(),o())},dependencies:[$,I],styles:[".conteiner-login[_ngcontent-%COMP%]{width:clamp(250px,100dvw,1300px);display:flex;justify-content:center;align-items:center;flex-direction:column;padding:30px 15px;font-size:clamp(12px,2dvw,16px);gap:20px}.conteiner-login__form[_ngcontent-%COMP%]{position:relative;width:100%;display:flex;justify-content:center;align-items:center;flex-direction:column;gap:10px}.conteiner-login__form--item[_ngcontent-%COMP%]{position:relative;width:50%;display:flex;justify-content:center;align-items:flex-start;flex-direction:column;gap:5px}@media screen and (max-width: 700px){.conteiner-login__form--item[_ngcontent-%COMP%]{width:90%}}.conteiner-login__form--item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:1.2em;color:#065693}.conteiner-login__form--item[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;background:#f5f5f5;border:none;outline:none;border-bottom:1px solid #065693;padding:10px 0}.conteiner-login__form--item[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{position:relative;width:100%}.conteiner-login__form--item[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{position:absolute;right:10px;top:-35px;color:#065693;font-size:1.1em}.conteiner-login__form--item[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-size:1.1em;color:#065693;font-weight:700;letter-spacing:2px;text-decoration:underline;padding:10px}.conteiner-login__form[_ngcontent-%COMP%]   .center[_ngcontent-%COMP%]{display:grid;place-items:center;padding-top:10px}.separator[_ngcontent-%COMP%]{width:98%;height:4px;margin-top:40px;background-color:#065693}@media screen and (max-width: 700px){.separator[_ngcontent-%COMP%]{width:90%}}"]});let e=n;return e})();export{be as LoginComponent};
